<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
	<title>企业服务</title>
	<link rel="stylesheet" type="text/css" href="static/css/index.css" />
	<link rel="stylesheet" type="text/css" href="static/css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="static/css/iview.min.css" />
	<link rel="stylesheet" type="text/css" href="static/css/vuetify.min.css" />
	<link rel="stylesheet" type="text/css" href="static/css/materialdesignicons.min.css" />
	<link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
	<link href="https://cdn.jsdelivr.net/npm/@mdi/font@5.x/css/materialdesignicons.min.css" rel="stylesheet">
	<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />
	<!-- <link rel="stylesheet" type="text/css" href="static/css/animate.min.css" /> -->

	<!-- <link rel="stylesheet" type="text/css" href="static/css/quasar.min.css" /> -->
</head>

<style>
	[v-cloak] {
		display: none;
	}

	.box {
		box-sizing: border-box;
		padding: 0 15vw;
	}

	.v-application--wrap {
		min-height: 60vh;
	}

	.v-application p {
		margin-bottom: 0;
	}

	.v-btn--fab.v-size--default {
		width: 3vw;
		height: 3vw;
		min-width: 30px;
		min-height: 30px;
	}

	.v-btn-toggle:not(.v-btn-toggle--dense) .v-btn.v-btn.v-size--default {
		height: 3vw
	}

	.col {
		display: flex;
		justify-content: center;
		align-items: center
	}

	.v-btn__content {
		font-size: 1.2rem
	}

	.v-card__title {
		background: darkseagreen;
	}

	.basil {
		background-color: #FFFBE6 !important;
	}

	.basil--text {
		color: #356859 !important;
	}

	.v-sheet.v-footer {
		display: flex;
		justify-content: center
	}

	.indigo {
		background-color: #5c6bc0 !important;
		border-color: #5c6bc0 !important;
	}
</style>

<body>
	<div id="app" class="" v-cloak>

		<div class="row header">
			<div class="left  col-sm-0 col-md-5 col-lg-5">
				<div class="">
					<img class="logo" src="./static/img/logo.png" alt="" title="安广·规上古">
				</div>
			</div>
			<div class="right  col-sm-5 col-md-5 col-lg-5">
				<v-row>
					<v-col>
						<v-btn-toggle v-model="text" tile color="deep-purple accent-3" group>
							<v-btn :value="url.title" v-for='(url,index) in toUrl' :key='index'>
								<a :href="url.url">{{url.title}}</a>
							</v-btn>

							<v-btn value="需求">
								我有需求
							</v-btn>
						</v-btn-toggle>
					</v-col>
				</v-row>
			</div>
		</div>
		<v-app>
			<div class="box">

				<v-card color="basil" style="width:100%">

					<v-card-title class="text-center justify-center py-6">
						<p class="font-weight-bold display-3 basil--text " style="width:100%">企业服务</p>
					</v-card-title>
					<v-tabs vertical>
						<div ref='element'>
							<v-tab class="tab-title" v-for='(tab,index) in tabsList' :key='index'
								@click='getData(tab.id)'>
								{{tab.title}}
							</v-tab>
						</div>


						<v-tab-item v-for='(tab,index) in tabsList' :key='index'>
							<v-card flat>
								<div class="card" :style="{'min-height':tabHeight + 'px'}">
									<p class="title">{{tabData.category}}</p>
									<div class="text-center">
										<v-btn class="mx-2" fab dark color="teal" @click='consult(tabData.cid)'>
											<span>咨询</span>
										</v-btn>
									</div>
									<div class="link">
										<div><span>负责人：</span>{{tabData.name}}</div>
										<div><span>联系电话：</span>{{tabData.phone}}</div>
									</div>
									<img :src="tabData.img" alt="">
									<div class="m-divider">
										<p></p>
										<span>服务介绍</span>
										<p></p>
									</div>
									<div class="content">
										{{tabData.detail}}
									</div>
								</div>


							</v-card>
						</v-tab-item>

					</v-tabs>

				</v-card>

				<v-footer padless>
					<v-card flat tile class="indigo lighten-1 white--text text-center">
						<v-divider></v-divider>
						<v-card-text class="white--text " style="width:100%">
							{{ new Date().getFullYear() }} — <strong>安广 · 规上古</strong>
						</v-card-text>
					</v-card>
				</v-footer>
			</div>

			<!-- 咨询框 -->
			<v-row justify="center">
				<v-dialog v-model="dialog" max-width="600px" max-height='600px'>
					
					

					<v-form ref="form" v-model="valid" lazy-validation>
						<v-card>
							<v-card-title>
								<span class="headline">咨询内容</span>
							</v-card-title>
							<div class="chat">
									<div >
										<div class="message-item" v-for='(chat,i) in chatList' :key='i' :class="chat.MsgType ? 'right' : 'left' ">
											<div class="content">{{chat.MsgContent}}</div>
										</div>
									</div>
							</div>
							<v-card-text>
								<v-container>
									<v-row>

										<v-col cols="12">
											<v-text-field label="咨询类型：" disabled :placeholder='tabData.category'>
											</v-text-field>
										</v-col>
										<v-textarea v-model="tip" clearable :rules="[rules.required]"
											placeholder='请输入咨询内容(必填)' auto-grow filled color="deep-purple" label="咨询内容"
											rows="3" required>
										</v-textarea>
									</v-row>
								</v-container>
							</v-card-text>
							<v-card-actions>
								<v-spacer></v-spacer>
								<v-btn color="blue darken-1" text @click="dialog = false">取消</v-btn>
								<v-btn color="blue darken-1" text @click="submit(tabData.cid)">提交</v-btn>
							</v-card-actions>
						</v-card>
					</v-form>
				</v-dialog>
			</v-row>



		</v-app>
	</div>


	<script src="static/js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
	<!-- <script src="static/js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script> -->
	<script src="static/js/axios.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="static/js/vue.js" type="text/javascript" charset="utf-8"></script>
	<script src="static/js/iview.min.js" type="text/javascript" charset="utf-8"></script>
	<script src="static/js/vuetify.js" type="text/javascript" charset="utf-8"></script>
	<script src="static/js/request.js" type="text/javascript" charset="utf-8"></script>

	<script type="text/javascript">
		new Vue({
			el: '#app',
			vuetify: new Vuetify(),
			data: function () {
				return {
					tabsList: [
						'选项1', '选项2', '选项3'
					],
					tabData: '',
					tabHeight: '',
					dialog: false,
					tip: '',
					valid: true,
					rules: {
						required: v => !!v || '这是必填的内容',
					},
					text: 'center',
					toUrl: [{
							title: '众创空间',
							url: 'index.html'
						},
						{
							title: '规上古头条',
							url: 'news.html'
						},
						{
							title: '环保科技链',
							url: 'links.html'
						},
						{
							title: '企业服务',
							url: 'services.html'
						},

					],
					chatList:[
						{
							MsgType:true,
							MsgContent:'用户消息'
						},
						{
							MsgType:false,
							MsgContent:'回复消息回复消息回复消息回复消息回复消息回复消息回复消息回复消息回复消息回复消息回复消息回复消息回复消息'
						},
						{
							MsgType:false,
							MsgContent:'回复消息1'
						},
						{
							MsgType:true,
							MsgContent:'用户消息用户消息用户消息用户消息用户消息用户消息'
						},

					]

				}
			},
			created() {

			},
			beforeMount() {

			},
			mounted() {
				this.init();
				this.getData(32);
				this.getHeight()
			},
			methods: {
				getHeight() {
					// this.tabHeight = this.$refs.element.offsetHeight * 2;
					this.tabHeight = window.innerHeight - 240;
					console.log(this.tabHeight)
				},
				init() {
					let postData = {
						Function: 'GetEnterpriseServiceType',
						page: 1,
						rows: 10,
					};
					// postData = JSON.stringify(postData);
					Post('/api/Incubator/APIMethod', postData)
						.then(res => {
							console.log(res);
							this.tabsList = res.data.data
						})
						.catch(err => {
							console.log(err)
						})
				},
				getData(id) {
					let postData = {
						Function: 'GetEnterpriseService',
						page: 1,
						rows: 10,
						id: id
					};
					// postData = JSON.stringify(postData);
					Post('/api/Incubator/APIMethod', postData)
						.then(res => {
							console.log(res);
							this.tabData = res.data.data[0]
						})
						.catch(err => {
							console.log(err)
						})
				},
				consult(id){
					if(!localStorage.getItem('user')){
							this.$Message.error('请先登录');
						}else{
							this.dialog = true;
							this.getChat(id);
						}
				},
				submit(id) {
					// this.dialog = false;
					if (this.$refs.form.validate()) {
						
						// this.$refs.form.reset()
						console.log(id);
						console.log(this.tip);
						let postData = {
						Function: 'InsertConsultation',
						id: id,
						intro: this.tip,
						openid:'123456'
					};
					// postData = JSON.stringify(postData);
					Post('/api/Incubator/APIMethod', postData)
						.then(res => {
							console.log(res);
						})
						.catch(err => {
							console.log(err)
						})
							
					
					}
				},

				getChat(id){
					let postData = {
						Function: 'GetConsultation',
						id: id,
						page: 1,
						rows: 10,
						openid:'123456'
					};
					// postData = JSON.stringify(postData);
					Post('/api/Incubator/APIMethod', postData)
						.then(res => {
							console.log(res);
						})
						.catch(err => {
							console.log(err)
						})
				}

			}
		})
	</script>
</body>

</html>